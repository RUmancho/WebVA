{% extends "base.html" %}

{% block content %}
<nav class="navbar navbar-dark mb-4">
    <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">üéì {{ page_title }}</span>
        <div>
            <span class="text-white me-3">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.first_name }}! üëã</span>
            <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm">üö™ –í—ã–π—Ç–∏</a>
        </div>
    </div>
</nav>

<div class="row">
    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <div class="col-md-3">
        <div class="sidebar">
            <h5>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h5>
            <p><strong>{{ user.first_name }} {{ user.last_name }}</strong></p>
            <p>–†–æ–ª—å: {{ user.role }}</p>
            <p>Email: {{ user.email }}</p>
            
            {% if user.role == '–£—á–µ–Ω–∏–∫' %}
                <p>–ì–æ—Ä–æ–¥: {{ user.city or '–ù–µ —É–∫–∞–∑–∞–Ω' }}</p>
                <p>–®–∫–æ–ª–∞: {{ user.school or '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}</p>
                <p>–ö–ª–∞—Å—Å: {{ user.class_number or '–ù–µ —É–∫–∞–∑–∞–Ω' }}</p>
            {% elif user.role == '–£—á–∏—Ç–µ–ª—å' %}
                <p>–ì–æ—Ä–æ–¥: {{ user.city or '–ù–µ —É–∫–∞–∑–∞–Ω' }}</p>
                <p>–®–∫–æ–ª–∞: {{ user.school or '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}</p>
                {% if user.subjects %}
                    <p>–ü—Ä–µ–¥–º–µ—Ç—ã: {{ user.subjects }}</p>
                {% endif %}
            {% endif %}
            
            <hr>
            <a href="{{ url_for('logout') }}" class="btn btn-danger w-100 mb-2">üö™ –í—ã–π—Ç–∏</a>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="col-md-9">
        <ul class="nav nav-tabs" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'home' %}active{% endif %}" 
                        onclick="showTab('home')" type="button">üè† –ì–ª–∞–≤–Ω–∞—è</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'teachers' %}active{% endif %}" 
                        onclick="showTab('teachers')" type="button">üë®‚Äçüè´ –£—á–∏—Ç–µ–ª—è</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'chat' %}active{% endif %}" 
                        onclick="showTab('chat')" type="button">üí¨ –ß–∞—Ç-–ø–æ–º–æ—â–Ω–∏–∫</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'theory' %}active{% endif %}" 
                        onclick="showTab('theory')" type="button">üìö –¢–µ–æ—Ä–∏—è</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'testing' %}active{% endif %}" 
                        onclick="showTab('testing')" type="button">üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'formulas' %}active{% endif %}" 
                        onclick="showTab('formulas')" type="button">üìê –§–æ—Ä–º—É–ª—ã</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'notifications' %}active{% endif %}" 
                        onclick="showTab('notifications')" type="button">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'personal_chat' %}active{% endif %}" 
                        onclick="showTab('personal_chat')" type="button">üí≠ –ß–∞—Ç</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'requests' %}active{% endif %}" 
                        onclick="showTab('requests')" type="button">üìã –ó–∞—è–≤–∫–∏</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'calls' %}active{% endif %}" 
                        onclick="showTab('calls')" type="button">üìû –ó–≤–æ–Ω–∫–∏</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if active_tab == 'lessons' %}active{% endif %}" 
                        onclick="showTab('lessons')" type="button">üé• –ó–∞–ø–∏—Å–∏ —É—Ä–æ–∫–æ–≤</button>
            </li>
        </ul>
        
        <div class="tab-content mt-4">
            <div id="home" class="tab-pane {% if active_tab == 'home' %}active{% endif %}">
                {% include 'dashboard/home.html' %}
            </div>
            <div id="teachers" class="tab-pane {% if active_tab == 'teachers' %}active{% endif %}">
                {% include 'dashboard/teachers.html' %}
            </div>
            <div id="chat" class="tab-pane {% if active_tab == 'chat' %}active{% endif %}">
                {% include 'dashboard/chat.html' %}
            </div>
            <div id="theory" class="tab-pane {% if active_tab == 'theory' %}active{% endif %}">
                {% include 'dashboard/theory.html' %}
            </div>
            <div id="testing" class="tab-pane {% if active_tab == 'testing' %}active{% endif %}">
                {% include 'dashboard/testing.html' %}
            </div>
            <div id="formulas" class="tab-pane {% if active_tab == 'formulas' %}active{% endif %}">
                {% include 'dashboard/formulas.html' %}
            </div>
            <div id="notifications" class="tab-pane {% if active_tab == 'notifications' %}active{% endif %}">
                {% include 'dashboard/notifications.html' %}
            </div>
            <div id="personal_chat" class="tab-pane {% if active_tab == 'personal_chat' %}active{% endif %}">
                {% include 'dashboard/personal_chat.html' %}
            </div>
            <div id="requests" class="tab-pane {% if active_tab == 'requests' %}active{% endif %}">
                {% include 'dashboard/requests.html' %}
            </div>
            <div id="calls" class="tab-pane {% if active_tab == 'calls' %}active{% endif %}">
                {% include 'dashboard/calls.html' %}
            </div>
            <div id="lessons" class="tab-pane {% if active_tab == 'lessons' %}active{% endif %}">
                {% include 'dashboard/lessons.html' %}
            </div>
        </div>
    </div>
</div>

<script>
function showTab(tabName) {
    // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
    document.querySelectorAll('.tab-pane').forEach(pane => {
        pane.classList.remove('active');
    });
    
    // –£–±—Ä–∞—Ç—å active —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
    document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
    });
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
    document.getElementById(tabName).classList.add('active');
    event.target.classList.add('active');
    
    // –û–±–Ω–æ–≤–∏—Ç—å URL –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    const url = new URL(window.location);
    url.searchParams.set('tab', tabName);
    window.history.pushState({}, '', url);
}
</script>
{% endblock %}

