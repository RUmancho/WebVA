{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="text-center mb-4">
            <h1 class="display-4">üéì –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
            <hr>
        </div>
        
        <div class="card">
            <div class="card-body">
                <form method="POST" action="{{ url_for('register') }}">
                    <h3 class="mb-3">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="email" class="form-label">Email*</label>
                            <input type="email" class="form-control" id="email" name="email" 
                                   placeholder="example@mail.com" 
                                   value="{{ form_data.email if form_data else '' }}" required>
                        </div>
                        <div class="col-md-6">
                            <label for="role" class="form-label">–†–æ–ª—å*</label>
                            <select class="form-select" id="role" name="role" required onchange="toggleRoleFields()">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å</option>
                                <option value="–£—á–µ–Ω–∏–∫" {% if form_data and form_data.role == '–£—á–µ–Ω–∏–∫' %}selected{% endif %}>–£—á–µ–Ω–∏–∫</option>
                                <option value="–£—á–∏—Ç–µ–ª—å" {% if form_data and form_data.role == '–£—á–∏—Ç–µ–ª—å' %}selected{% endif %}>–£—á–∏—Ç–µ–ª—å</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="password" class="form-label">–ü–∞—Ä–æ–ª—å*</label>
                            <input type="password" class="form-control" id="password" name="password" 
                                   placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" required>
                            <small class="form-text text-muted">–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤, –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã</small>
                        </div>
                        <div class="col-md-6">
                            <label for="password_confirm" class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å*</label>
                            <input type="password" class="form-control" id="password_confirm" name="password_confirm" required>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="first_name" class="form-label">–ò–º—è*</label>
                            <input type="text" class="form-control" id="first_name" name="first_name" 
                                   placeholder="–ò–≤–∞–Ω" 
                                   value="{{ form_data.first_name if form_data else '' }}" required>
                        </div>
                        <div class="col-md-6">
                            <label for="last_name" class="form-label">–§–∞–º–∏–ª–∏—è*</label>
                            <input type="text" class="form-control" id="last_name" name="last_name" 
                                   placeholder="–ò–≤–∞–Ω–æ–≤" 
                                   value="{{ form_data.last_name if form_data else '' }}" required>
                        </div>
                    </div>
                    
                    <!-- –ü–æ–ª—è –¥–ª—è —É—á–µ–Ω–∏–∫–∞ -->
                    <div id="student_fields" style="display: none;">
                        <h3 class="mb-3">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—á–µ–Ω–∏–∫–µ</h3>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="city" class="form-label">–ì–æ—Ä–æ–¥*</label>
                                <input type="text" class="form-control" id="city" name="city" 
                                       placeholder="–ú–æ—Å–∫–≤–∞" 
                                       value="{{ form_data.city if form_data else '' }}">
                            </div>
                            <div class="col-md-4">
                                <label for="school" class="form-label">–®–∫–æ–ª–∞*</label>
                                <input type="text" class="form-control" id="school" name="school" 
                                       placeholder="–ú–ë–û–£ –°–û–® ‚Ññ1" 
                                       value="{{ form_data.school if form_data else '' }}">
                            </div>
                            <div class="col-md-4">
                                <label for="class_number" class="form-label">–ö–ª–∞—Å—Å*</label>
                                <input type="text" class="form-control" id="class_number" name="class_number" 
                                       placeholder="10–ê" 
                                       value="{{ form_data.class_number if form_data else '' }}">
                            </div>
                        </div>
                    </div>
                    
                    <!-- –ü–æ–ª—è –¥–ª—è —É—á–∏—Ç–µ–ª—è -->
                    <div id="teacher_fields" style="display: none;">
                        <h3 class="mb-3">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—á–∏—Ç–µ–ª–µ</h3>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="city_teacher" class="form-label">–ì–æ—Ä–æ–¥*</label>
                                <input type="text" class="form-control" id="city_teacher" name="city" 
                                       placeholder="–ú–æ—Å–∫–≤–∞" 
                                       value="{{ form_data.city if form_data else '' }}">
                            </div>
                            <div class="col-md-6">
                                <label for="school_teacher" class="form-label">–®–∫–æ–ª–∞*</label>
                                <input type="text" class="form-control" id="school_teacher" name="school" 
                                       placeholder="–ú–ë–û–£ –°–û–® ‚Ññ1" 
                                       value="{{ form_data.school if form_data else '' }}">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="subjects" class="form-label">–ü—Ä–µ–¥–º–µ—Ç—ã*</label>
                            <textarea class="form-control" id="subjects" name="subjects" rows="3" 
                                      placeholder="–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, –§–∏–∑–∏–∫–∞, –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞">{{ form_data.subjects if form_data else '' }}</textarea>
                            <small class="form-text text-muted">–£–∫–∞–∂–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç—ã —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é</small>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-2">
                            <button type="submit" class="btn btn-primary w-100">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                        </div>
                        <div class="col-md-6 mb-2">
                            <a href="{{ url_for('login') }}" class="btn btn-outline-secondary w-100">–ù–∞–∑–∞–¥ –∫ –≤—Ö–æ–¥—É</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
function toggleRoleFields() {
    const role = document.getElementById('role').value;
    const studentFields = document.getElementById('student_fields');
    const teacherFields = document.getElementById('teacher_fields');
    
    if (role === '–£—á–µ–Ω–∏–∫') {
        studentFields.style.display = 'block';
        teacherFields.style.display = 'none';
        // –î–µ–ª–∞–µ–º –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏
        document.getElementById('city').required = true;
        document.getElementById('school').required = true;
        document.getElementById('class_number').required = true;
        document.getElementById('city_teacher').required = false;
        document.getElementById('school_teacher').required = false;
        document.getElementById('subjects').required = false;
    } else if (role === '–£—á–∏—Ç–µ–ª—å') {
        studentFields.style.display = 'none';
        teacherFields.style.display = 'block';
        // –î–µ–ª–∞–µ–º –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏
        document.getElementById('city').required = false;
        document.getElementById('school').required = false;
        document.getElementById('class_number').required = false;
        document.getElementById('city_teacher').required = true;
        document.getElementById('school_teacher').required = true;
        document.getElementById('subjects').required = true;
    } else {
        studentFields.style.display = 'none';
        teacherFields.style.display = 'none';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    toggleRoleFields();
});
</script>
{% endblock %}

